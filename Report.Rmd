---
title: 'STAT 3302 Project Report'
author: "Edison Gu, "
date: "04/17/2020"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, cache = TRUE)
library(tidyverse)
# library(readr)
# library(alr4)
library(GGally)
# library(broom)
# library(ggpubr)
tb <- read_csv("Employee_Attrition.csv")
```

## Data Preprocessing

```{r preprocessing}
ea = tb

glimpse(ea)

```

## EDA

```{r EDA}
# ggpairs(ea)
for (i in seq_along(ea)){
        print(paste(i,")",colnames(ea)[i]))
        if(length(pull(unique(ea[i])))<40){
                 plot = ea %>% ggplot() + geom_bar(aes_string(colnames(ea)[i]))
        } else {
                plot = ea %>% ggplot() + geom_density(aes_string(colnames(ea)[i]))
        }
        print(plot)
}
```

```{r}
ea %>% select(HourlyRate, DailyRate, MonthlyRate, MonthlyIncome) %>% 
        ggpairs()
```


```{r}
df = ea %>% select(MonthlyRate, MonthlyIncome)
par(mfrow=c(1,1))
matplot(t(df), type="l", xaxt="n", col="gray",
        xlab="Variable", ylab="Measurement")
axis(side=1, at=1:2, names(df))
points(1:2, colMeans(df), cex=1, pch=20, type="b", lwd=2)
```

```{r}
df = ea %>% select(YearsInCurrentRole, YearsWithCurrManager)
df %>% ggplot(aes(x=YearsInCurrentRole, y =YearsWithCurrManager))+geom_jitter()
df %>% ggplot(aes(x=YearsInCurrentRole, y =YearsWithCurrManager))+geom_point()
```

```{r}
par(mfrow=c(1,1))
matplot(t(df), type="l", xaxt="n", col="gray",
        xlab="Variable", ylab="Measurement")
axis(side=1, at=1:2, names(df))
points(1:2, colMeans(df), cex=1, pch=20, type="b", lwd=2)
```













